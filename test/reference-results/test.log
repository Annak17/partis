TEST              annotate-ref-simu   ./bin/partis.py --action run-viterbi --plotdir test/_new-results/simu-ref-performance --plot-performance --is-simu --seqfile test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu/hmm --seed 1 --n-procs 10 --only-genes IGHV4-61*08:IGHV3-48*01:IGHV5-51*02:IGHV3-69-1*02:IGHV1/OR15-1*04:IGHV3-66*03:IGHV3-23D*01:IGHV3-71*03:IGHV1-2*04:IGHV1-2*02:IGHD3-16*02:IGHD2-2*03:IGHD2-8*01:IGHD3-22*01:IGHD6-13*01:IGHD4-17*01:IGHD6-19*01:IGHD3-10*01:IGHD2-15*01:IGHD2-21*02:IGHJ5*02:IGHJ3*02:IGHJ2*01:IGHJ1*01:IGHJ6*03:IGHJ4*02 --only-csv-plots --outfname test/_new-results/annotate-ref-simu.csv
    TODO make sure all mpl figures are getting closed
    TODO remove extra assertions from glomerator
    TODO make sure all trace of truncation is removed from ham (including cyst position stuff)
    TODO in addition to translating from a large cluster to a smaller one, you should also not recalculate just 'cause you add one sequence to a huge cluster
    TODO fix WriteAnnotations in glomerator (and/i.e. clean up events_ filling, in particular in ReplaceNaiveSeq)
    TODO besides "replacing" clusters with smaller subsets, you should, when making the merged cluster object, not recalculate unless it's really different
    TODO make things completely assertion/exception safe, i.e. if you catch one, that causes a failure on that one sequence only
   adding placeholder alignments for missing genes [91mj[0m[95m1P[0m[93m01[0m [91mj[0m[95m2P[0m[93m01[0m [91mj[0m[95m3P[0m[93m01[0m [91mj[0m[95m3P[0m[93m02[0m
smith-waterman
    rewriting germlines from /home/dralph/work/partis-dev/data/imgt to /tmp/dralph/hmms/535826/germline-sets (using 26 genes)
        processed       remaining      new-indels          rerun: unproductive      no-match      weird-annot.      nonsense-bounds      invalid-codon
           997             178              0                          68              85              23               0               2             increasing mismatch score (1 --> 2) and rerunning them
           178              10              3                           0               5               0               2               0             rerunning for indels
    skipping performance evaluation of 7534029448258028519 because of indels
    skipping performance evaluation of 6387888212624103929 because of indels
            10               8              0                           0               6               0               2               0             increasing mismatch score (2 --> 3) and rerunning them
/usr/lib/pymodules/python2.7/matplotlib/pyplot.py:412: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_num_figures`).
  max_open_warning, RuntimeWarning)
             8               2              0                           0               1               0               1               0             increasing mismatch score (3 --> 4) and rerunning them
  v_gene
    correct up to allele:  920 / 993  = 0.9265 (-0.918, +0.934)
  d_gene
    correct up to allele:  812 / 993  = 0.8177 (-0.805, +0.829)
  j_gene
    correct up to allele:  893 / 993  = 0.8993 (-0.889, +0.908)
      info for 995      (skipped 0 / 997 = 0.000 unproductive    2 / 997 = 0.002 other ) 
   [91mwarning[0m 2 missing annotations (1662516315931078001:-8821941325994925903)
hmm
    writing input
    running
      hmm run time: 19.162
    time to merge csv files: 0.023
    read output
    skipping performance evaluation of 7534029448258028519 because of indels
    skipping performance evaluation of 6387888212624103929 because of indels
  v_gene
    correct up to allele:  823 / 993  = 0.8288 (-0.817, +0.840)
  d_gene
    correct up to allele:  844 / 993  = 0.8499 (-0.838, +0.860)
  j_gene
    correct up to allele:  945 / 993  = 0.9517 (-0.944, +0.957)
    processed 995 sequences in 995 events (0 invalid events)
      1 boundary errors
missing 2 input keys
      total time: 49.320
